# Avito banner

## Content

1. [Handlers](#Handlers) \
    1.1 [Authorization](#Authorization) \
    1.2.[Banners API](#Banners-API)
2. [Проблемы, с которыми столкнулся и их решения](#Проблемы-с-которыми-столкнулся-и-их-решения)
3. [Load Testing](#Load-Testing)


# Handlers

## Authorization
1. POST: /auth/sign-up \
    Регистрация пользователя
2. POST: /auth/sign-in \
    Аутентификация. При успешной авторизации возвращает JWT Token.
   
## Banners API
1. GET: /api/v1/banners \
   Получение всех баннеров с фильтрацией по фиче и тегу и параметрам limit, offset.Требуется админский токен 
2. POST: /api/v1/banners \
   Создание нового банера..Требуется админский токен 
3. DELETE: /api/v1/banners/{id} \
   Удаление баннера по id..Требуется админский токен 
4. PATCH: /api/v1/banners/{id} \
   Обновление баннера по id..Требуется админский токен 
5. GET: /api/v1/user_banner \
   Получение баннера по фиче и тегу.Достаточно пользовательского токена 
6. DELETE: /api/v1/delete \
    Удаление баннера по фиче и тегу. .Требуется админский токен

# Проблемы, с которыми столкнулся и их решения
- В техническом задании не было указано, как добавлять пользователей в базу данных и какой уровень доступа им присваивать. Исходя из этого, каждый пользователь, зарегистрированный через обработчик /auth/sign-up, получает обычный токен. Однако, если необходимо получить административный токен, необходимо войти через /auth/sign-in, используя логин и пароль, указанные в конфигурации env. Также в jwt.Claims записывается массив ролей пользователя. Это позволяет проводить дальнейшее масштабирование. К примеру у пользователя может быть ["Admin","System_admin"],в котором у каждой роли свои права и ограничения  
- Вопрос был также в том, что заносить в кэш. Ведь получать все записи из бд непрактично,но  при этом нет критериев,чтобы определять популярные запросы. Мой подход был следующим: при запросе пользователя,если записи нет в кэше,то запись вносится в кэш.При этом через определенное время кэш очищается

# Load Testing
  Для нагрузочного тестирования использовал технологии k6. В папке loadtest можно посмотреть результаты тестов(есть как выводы в консоли,так и графические представления)
